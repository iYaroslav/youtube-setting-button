{"version":3,"sources":["../../src/index.tsx","App.js","index.js"],"names":["Menu","settings","onChange","useState","current","setCurrent","pages","useMemo","_settings","deepClone","Array","arr","i","obj","cloned","fillPage","page","items","key","title","value","checked","str","parent","_items","s","onClick","setting","allowCustomValue","onOtherValueSelected","multiselectable","onBackClick","getMeta","React","className","styles","header","menu","item","style","menuClassName","hd","ref","useRef","defaultOpen","closeOnOutsideClick","closeOnEsc","openPortal","isOpen","portal","height","version","viewBox","width","d","App","entries","prompt","config","setConfig","position","top","left","marginLeft","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.44690a8d.chunk.js","sourcesContent":["import React, {\n  useRef,\n  useState,\n  useMemo,\n  CSSProperties,\n  ReactNode,\n  Key\n} from 'react'\nimport { PortalWithState } from 'react-portal'\nimport styles from './styles.module.css'\n\nfunction deepClone<T>(obj: T): T {\n  if (Array.isArray(obj)) {\n    const arr = []\n    for (let i = 0; i < obj.length; i++) {\n      arr[i] = deepClone(obj[i])\n    }\n\n    // @ts-ignore\n    return arr\n  }\n\n  if (typeof obj === 'object') {\n    const cloned = {}\n    for (const key in obj) {\n      // @ts-ignore\n      cloned[key] = deepClone(obj[key])\n    }\n\n    // @ts-ignore\n    return cloned\n  }\n\n  return obj\n}\n\nexport interface Item {\n  key: Key\n  title: ReactNode\n  value?: boolean | ReactNode\n  checked?: boolean\n}\n\nexport interface Setting extends Item {\n  entries?: string[] | Setting[]\n  allowCustomValue?: boolean\n  onOtherValueSelected?: () => ReactNode\n}\n\ninterface PageItem extends Item {\n  onClick: () => void\n}\n\ninterface Page {\n  key: Key\n  title?: ReactNode\n  allowCustomValue?: boolean\n  onOtherValueSelected?: () => ReactNode\n  multiselectable?: boolean\n  items: PageItem[]\n  onBackClick?: () => void\n}\n\nexport interface MenuProps {\n  settings: Setting[]\n  // onOtherSelect?: () => ReactNode\n  title?: ReactNode\n  // multiselectable: boolean\n  // allowCustomValue: boolean\n  onChange?: (settings: Setting[]) => void\n}\n\nexport interface Props extends MenuProps {\n  hd?: boolean\n  active?: boolean\n  className?: string\n  menuClassName?: string\n  style?: CSSProperties\n  settings: Setting[]\n  onChange?: (settings: Setting[]) => void\n}\n\nconst Menu = ({ settings, onChange = () => {} }: MenuProps) => {\n  const [current, setCurrent] = useState<Key>('main')\n\n  const pages = useMemo(() => {\n    const _settings = deepClone(settings)\n\n    const pages: Page[] = []\n\n    const boolToReactNode = (value: boolean) => {\n      // TODO use switch!\n      return value ? 'Yep' : 'Nope'\n    }\n\n    const getMeta = (setting: Setting | undefined, key?: Key) => {\n      if (!setting) return {}\n\n      return {\n        title: setting.title,\n        allowCustomValue: setting.allowCustomValue,\n        onOtherValueSelected: setting.onOtherValueSelected,\n        multiselectable:\n          setting.entries &&\n          setting.entries.length > 0 &&\n          typeof setting.entries[0] === 'string',\n        onBackClick: () => key && setCurrent(key)\n      }\n    }\n\n    const fillPage = (\n      items: string[] | Setting[],\n      key: Key,\n      parent?: Setting,\n      parentKey?: Key\n    ) => {\n      let _items: Setting[]\n      if (items.length && typeof items[0] === 'string') {\n        // @ts-ignore\n        _items = items.map((str: string) => ({\n          key: str,\n          title: str,\n          value: undefined,\n          checked: str === parent?.value\n        }))\n      } else {\n        _items = items as Setting[]\n      }\n\n      const page: Partial<Page> = {\n        items: _items.map((s) => {\n          if (s.entries) {\n            fillPage(s.entries, s.key, s, key)\n          }\n\n          return {\n            key: s.key,\n            title: s.title,\n            checked: s.checked,\n            value:\n              typeof s.value === 'boolean' ? boolToReactNode(s.value) : s.value,\n            onClick: () => {\n              if (s.entries) {\n                setCurrent(s.key)\n                return\n              }\n\n              if (typeof s.value === 'boolean') {\n                s.value = !s.value\n              } else {\n                if (parent) {\n                  parent.value = s.title\n                  if (parentKey) {\n                    setCurrent(parentKey)\n                  }\n                }\n              }\n\n              onChange(_settings)\n            }\n          }\n        }),\n        ...getMeta(parent, parentKey)\n      }\n\n      page.key = key\n      pages.push(page as Page)\n    }\n\n    fillPage(_settings, 'main')\n    return pages\n  }, [settings])\n\n  return (\n    <React.Fragment>\n      {pages.map((page) => (\n        <div\n          className={[\n            styles.panel,\n            current === page.key && styles.current\n          ].join(' ')}\n          key={page.key}\n        >\n          <React.Fragment>\n            {page.title && (\n              <div className={styles.header}>\n                <div onClick={page.onBackClick}>{page.title}</div>\n                {page.allowCustomValue && (\n                  <div onClick={page.onOtherValueSelected}>Other</div>\n                )}\n              </div>\n            )}\n\n            <div\n              aria-multiselectable={page.multiselectable}\n              className={styles.menu}\n            >\n              {page.items.map((item) => (\n                <div\n                  key={item.key}\n                  className={styles.item}\n                  onClick={item.onClick}\n                  aria-checked={item.checked}\n                >\n                  <div>{item.title}</div>\n                  <div>{item.value}</div>\n                </div>\n              ))}\n            </div>\n          </React.Fragment>\n        </div>\n      ))}\n    </React.Fragment>\n  )\n}\n\nconst SettingButton = ({\n  style,\n  className,\n  menuClassName,\n  hd,\n  settings,\n  onChange\n}: Props) => {\n  const ref = useRef<HTMLDivElement>(null)\n\n  return (\n    <PortalWithState defaultOpen closeOnOutsideClick closeOnEsc>\n      {({ openPortal, isOpen, portal }) => (\n        <React.Fragment>\n          <div\n            ref={ref}\n            className={[styles.button, className, hd && styles.hd].join(' ')}\n            aria-expanded={isOpen}\n            style={style}\n            onClick={openPortal}\n          >\n            <svg height='100%' version='1.1' viewBox='0 0 36 36' width='100%'>\n              <path d='m 23.94,18.78 c .03,-0.25 .05,-0.51 .05,-0.78 0,-0.27 -0.02,-0.52 -0.05,-0.78 l 1.68,-1.32 c .15,-0.12 .19,-0.33 .09,-0.51 l -1.6,-2.76 c -0.09,-0.17 -0.31,-0.24 -0.48,-0.17 l -1.99,.8 c -0.41,-0.32 -0.86,-0.58 -1.35,-0.78 l -0.30,-2.12 c -0.02,-0.19 -0.19,-0.33 -0.39,-0.33 l -3.2,0 c -0.2,0 -0.36,.14 -0.39,.33 l -0.30,2.12 c -0.48,.2 -0.93,.47 -1.35,.78 l -1.99,-0.8 c -0.18,-0.07 -0.39,0 -0.48,.17 l -1.6,2.76 c -0.10,.17 -0.05,.39 .09,.51 l 1.68,1.32 c -0.03,.25 -0.05,.52 -0.05,.78 0,.26 .02,.52 .05,.78 l -1.68,1.32 c -0.15,.12 -0.19,.33 -0.09,.51 l 1.6,2.76 c .09,.17 .31,.24 .48,.17 l 1.99,-0.8 c .41,.32 .86,.58 1.35,.78 l .30,2.12 c .02,.19 .19,.33 .39,.33 l 3.2,0 c .2,0 .36,-0.14 .39,-0.33 l .30,-2.12 c .48,-0.2 .93,-0.47 1.35,-0.78 l 1.99,.8 c .18,.07 .39,0 .48,-0.17 l 1.6,-2.76 c .09,-0.17 .05,-0.39 -0.09,-0.51 l -1.68,-1.32 0,0 z m -5.94,2.01 c -1.54,0 -2.8,-1.25 -2.8,-2.8 0,-1.54 1.25,-2.8 2.8,-2.8 1.54,0 2.8,1.25 2.8,2.8 0,1.54 -1.25,2.8 -2.8,2.8 l 0,0 z' />\n            </svg>\n          </div>\n\n          {portal(\n            <div className={styles.portal}>\n              <div className={[styles.container, menuClassName].join(' ')}>\n                <Menu onChange={onChange} settings={settings} />\n              </div>\n            </div>\n          )}\n        </React.Fragment>\n      )}\n    </PortalWithState>\n  )\n}\n\nexport default SettingButton\n","import React, { useState } from 'react'\n\nimport Setting from '@iyaroslav/youtube-settings-button'\nimport '@iyaroslav/youtube-settings-button/dist/index.css'\n\nconst App = () => {\n  const [config, setConfig] = useState([{\n    key: 'autoplay',\n    title: 'Autoplay',\n    value: true\n  }, {\n    key: 'annotations',\n    title: 'Annotations',\n    value: true\n  }, {\n    key: 'speed',\n    title: 'Playback speed',\n    value: 'Normal',\n    entries: ['0.5', '0.75', 'Normal', '1.25', '1.5']\n  }, {\n    key: 'quality',\n    title: 'Quality',\n    value: 'UHD',\n    allowCustomValue: true,\n    onOtherValueSelected: () => prompt('Enter value'),\n    entries: ['SD', 'HD', 'UHD']\n  }])\n\n  return <div style={{\n    height: '150vh'\n  }}>\n    <p>Add <code>position: relative</code> style to body, for correct menu position\n    </p>\n    <Setting\n      style={{\n        position: 'absolute',\n        top: '25rem',\n        left: '50%',\n        marginLeft: '-1.6rem'\n      }}\n      hd\n      settings={config}\n      onChange={setConfig}\n    />\n  </div>\n}\n\nexport default App\n","import './index.css'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}